<html>

<head>
<script src="/ui/js/jquery.min.js"></script>
<script src="/ui/js/bootstrap.min.js"></script>
<script src="/ui/js/voice.js"></script>
<link rel="stylesheet" href="/ui/css/bootstrap.min.css"/>
</head>

<body>

   <br><br><br>

   <div class="row" style="text-align:center">
      <input id='user_input' type='text' style='width:40%'/>
      <a id="voice_recognition_button">
         <img id="start_img" src="/ui/images/mic.gif">
      </a>
   </div>

   <br><br>

   <div class="row" style="text-align:center">
      <div id='history'></div>
   </div>
</body>

</html>

<script>


   $(document).ready(function(){

      function process_human_input(text) {
         $('#history').prepend("<span style='color:blue'>H:"+text+"<span/><br>");

         data=JSON.stringify({"text": text});
         $.post("/ws.py/chat", data, function(result){
            if(result.length>0)
            {
               $('#history').prepend("<span style='color:red'>M:"+result+"<span/><br>");
               v.speak(result);
            }
         });
      }


      var v = new Voice();
      v.init(process_human_input);

      $('#voice_recognition_button').click(function(){
         if(!v.recognizing)
            v.recognition_start();
         else
            v.recognition_stop();
      });

      $('#user_input').bind("enter_key", function(e){
         text=$('#user_input').val();
         $('#user_input').val('');
         console.log(text);
         process_human_input(text);
      });

      $('#user_input').keyup(function(e){
         if(e.keyCode == 13)
         {
            $(this).trigger("enter_key");
         }
      });
   });
</script>
